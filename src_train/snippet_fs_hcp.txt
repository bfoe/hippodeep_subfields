 ~/cmd_freesurfer-dev.sh 

export SUBJECTS_DIR=/home1/user/data/hcp/freesurfer_repo_hcp


recon-all -s hcp_996782 -all -i 996782/T1w/T1w_acpc_dc.nii.gz 

cat /home1/user/data/hcp/ids.txt | head -100 | while read a; do echo antsApplyTransforms -i /home1/user/data/hcp/freesurfer_repo_hcp/hcp_${a}/mri/lh.hippoAmygLabels-T1.v21.FS60.mgz -r /home/user/devel/hippodeep-sub/test/croproi_MNI152_1mm.nii.gz -o /home/user/devel/hippodeep-sub/test/hcp_${a}_lh.nii.gz  -t /home1/user/data/hcp/mniaffines/T1w_acpc_dc_${a}_mni0Affine.txt -n NearestNeighbor; done | split -d -l 10

/home1/user/data/hcp/mniaffines/T1w_acpc_dc_223929_mni0Affine.txt

J'ai fait deux boxes:
/home/user/devel/hippodeep-sub/test/boxHippoL_64.nii.gz /home/user/devel/hippodeep-sub/test/boxHippoR_64.nii.gz




cd /home/user/devel/hippodeep-sub/data

# HCP:
cat ids_hcp | head -1 | while read a; do
    # Left
    echo antsApplyTransforms -i /home1/user/data/hcp/freesurfer_repo_hcp/${a}/mri/orig/001.mgz -t /home1/user/data/hcp/mniaffines/T1w_acpc_dc_${a#hcp_}_mni0Affine.txt -r /home/user/devel/hippodeep-sub/boxes/boxHippoL_128.nii.gz -o ${a}_001_orig_boxL.nii --float -n BSpline
    echo ConvertImagePixelType ${a}_001_orig_boxL.nii ${a}_001_orig_boxL.nii.gz 1
    echo /bin/rm ${a}_001_orig_boxL.nii

    echo antsApplyTransforms -i /home1/user/data/hcp/freesurfer_repo_hcp/${a}/mri/lh.hippoAmygLabels-T1.v21.FS60.mgz -t  /home1/user/data/hcp/mniaffines/T1w_acpc_dc_${a#hcp_}_mni0Affine.txt -r /home/user/devel/hippodeep-sub/boxes/boxHippoL_128.nii.gz -o ${a}_001_hippoAmyg_boxL.nii --float -n MultiLabel[0.03]
    echo fslmaths ${a}_001_hippoAmyg_boxL.nii -uthr 5000 ${a}_001_hippoAmyg_boxL.nii.gz -odt char
    echo /bin/rm ${a}_001_hippoAmyg_boxL.nii

    # Right
    echo antsApplyTransforms -i /home1/user/data/hcp/freesurfer_repo_hcp/${a}/mri/orig/001.mgz -t /home1/user/data/hcp/mniaffines/T1w_acpc_dc_${a#hcp_}_mni0Affine.txt -r /home/user/devel/hippodeep-sub/boxes/boxHippoR_128.nii.gz -o ${a}_001_orig_boxR.nii --float -n BSpline
    echo ConvertImagePixelType ${a}_001_orig_boxR.nii ${a}_001_orig_boxR.nii.gz 1
    echo /bin/rm ${a}_001_orig_boxR.nii

    echo antsApplyTransforms -i /home1/user/data/hcp/freesurfer_repo_hcp/${a}/mri/rh.hippoAmygLabels-T1.v21.FS60.mgz -t  /home1/user/data/hcp/mniaffines/T1w_acpc_dc_${a#hcp_}_mni0Affine.txt -r /home/user/devel/hippodeep-sub/boxes/boxHippoR_128.nii.gz -o ${a}_001_hippoAmyg_boxR.nii --float -n MultiLabel[0.03]
    echo fslmaths ${a}_001_hippoAmyg_boxR.nii -uthr 5000 ${a}_001_hippoAmyg_boxR.nii.gz -odt char
    echo /bin/rm ${a}_001_hippoAmyg_boxR.nii
done




# Ran FS hippo segmentHA_T1.sh
/home1/user/data/oasis3/oasis3_fs

# OASIS:
antsApplyTransforms -i /home1/user/data/oasis3/oasis3_fs/dl/OAS30579_MR_d1232/mri/orig/001.mgz -t /home1/user/data/oasis3/oasis3_parcelcortex/convseg/OAS30579_MR_d1232_001_mni0Affine.txt -r boxes/boxHippoL_128.nii.gz -o OAS30579_MR_d1232_001_orig_boxL.nii.gz --float -n BSpline

antsApplyTransforms -i /home1/user/data/oasis3/oasis3_fs/dl/OAS30579_MR_d1232/mri/lh.hippoAmygLabels-T1.v21.FS60.mgz -t /home1/user/data/oasis3/oasis3_parcelcortex/convseg/OAS30579_MR_d1232_001_mni0Affine.txt -r boxes/boxHippoL_128.nii.gz -o OAS30579_MR_d1232_001_hippoAmyg_boxL.nii.gz --float -n MultiLabel[0.03]

fslmaths OAS30579_MR_d1232_001_hippoAmyg_boxL.nii.gz -uthr 5000 OAS30579_MR_d1232_001_hippoAmyg_boxL.nii.gz -odt char



cat ids_oasis3 | head -1 | while read a; do
    # Left
    echo antsApplyTransforms -i /home1/user/data/oasis3/oasis3_fs/dl/${a}/mri/orig/001.mgz -t /home1/user/data/oasis3/oasis3_parcelcortex/convseg/${a}_001_mni0Affine.txt -r /home/user/devel/hippodeep-sub/boxes/boxHippoL_128.nii.gz -o ${a}_001_orig_boxL.nii --float -n BSpline
    echo ConvertImagePixelType ${a}_001_orig_boxL.nii ${a}_001_orig_boxL.nii.gz 1
    echo /bin/rm ${a}_001_orig_boxL.nii

    echo antsApplyTransforms -i /home1/user/data/oasis3/oasis3_fs/dl/${a}/mri/lh.hippoAmygLabels-T1.v21.FS60.mgz -t /home1/user/data/oasis3/oasis3_parcelcortex/convseg/${a}_001_mni0Affine.txt -r /home/user/devel/hippodeep-sub/boxes/boxHippoL_128.nii.gz -o ${a}_001_hippoAmyg_boxL.nii --float -n MultiLabel[0.03]
    echo fslmaths ${a}_001_hippoAmyg_boxL.nii -uthr 5000 ${a}_001_hippoAmyg_boxL.nii.gz -odt char
    echo /bin/rm ${a}_001_hippoAmyg_boxL.nii

    # Right
    echo antsApplyTransforms -i /home1/user/data/oasis3/oasis3_fs/dl/${a}/mri/orig/001.mgz -t /home1/user/data/oasis3/oasis3_parcelcortex/convseg/${a}_001_mni0Affine.txt -r /home/user/devel/hippodeep-sub/boxes/boxHippoR_128.nii.gz -o ${a}_001_orig_boxR.nii --float -n BSpline
    echo ConvertImagePixelType ${a}_001_orig_boxR.nii ${a}_001_orig_boxR.nii.gz 1
    echo /bin/rm ${a}_001_orig_boxR.nii

    echo antsApplyTransforms -i /home1/user/data/oasis3/oasis3_fs/dl/${a}/mri/rh.hippoAmygLabels-T1.v21.FS60.mgz -t /home1/user/data/oasis3/oasis3_parcelcortex/convseg/${a}_001_mni0Affine.txt -r /home/user/devel/hippodeep-sub/boxes/boxHippoR_128.nii.gz -o ${a}_001_hippoAmyg_boxR.nii --float -n MultiLabel[0.03]
    echo fslmaths ${a}_001_hippoAmyg_boxR.nii -uthr 5000 ${a}_001_hippoAmyg_boxR.nii.gz -odt char
    echo /bin/rm ${a}_001_hippoAmyg_boxR.nii
done | split -d -l 1584

# Ventricles
cat ids_oasis3 | head -1 | while read a; do
    # Left
    echo antsApplyTransforms -i  /home1/user/data/oasis3/oasis3_fs/dl/${a}/mri/aparc+aseg.mgz -t /home1/user/data/oasis3/oasis3_parcelcortex/convseg/${a}_001_mni0Affine.txt -r /home/user/devel/hippodeep-sub/boxes/boxHippoL_128.nii.gz -o ${a}_001_aseg_boxL.nii --float -n MultiLabel[0.01]
    echo fslmaths ${a}_001_aseg_boxL.nii -thr 3.5 -uthr 4.5 -bin ${a}_001_ventricle_Lat_boxL.nii.gz -odt char
    echo fslmaths ${a}_001_aseg_boxL.nii -thr 4.5 -uthr 5.5 -bin ${a}_001_ventricle_Inf_boxL.nii.gz -odt char
    echo fslmaths ${a}_001_ventricle_Inf_boxL.nii.gz -mul 2 -add ${a}_001_ventricle_Lat_boxL.nii.gz ${a}_001_ventricles_boxL.nii.gz
    echo /bin/rm ${a}_001_aseg_boxL.nii ${a}_001_ventricle_Lat_boxL.nii.gz ${a}_001_ventricle_Inf_boxL.nii.gz

    #Right
    echo antsApplyTransforms -i  /home1/user/data/oasis3/oasis3_fs/dl/${a}/mri/aparc+aseg.mgz -t /home1/user/data/oasis3/oasis3_parcelcortex/convseg/${a}_001_mni0Affine.txt -r /home/user/devel/hippodeep-sub/boxes/boxHippoR_128.nii.gz -o ${a}_001_aseg_boxR.nii --float -n MultiLabel[0.01]
    echo fslmaths ${a}_001_aseg_boxR.nii -thr 42.5 -uthr 43.5 -bin ${a}_001_ventricle_Lat_boxR.nii.gz -odt char
    echo fslmaths ${a}_001_aseg_boxR.nii -thr 43.5 -uthr 44.5 -bin ${a}_001_ventricle_Inf_boxR.nii.gz -odt char
    echo fslmaths ${a}_001_ventricle_Inf_boxR.nii.gz -mul 2 -add ${a}_001_ventricle_Lat_boxR.nii.gz ${a}_001_ventricles_boxR.nii.gz
    echo /bin/rm ${a}_001_aseg_boxR.nii ${a}_001_ventricle_Lat_boxR.nii.gz ${a}_001_ventricle_Inf_boxR.nii.gz
done

cat ids_hcp | head -1 | while read a; do
    # Left
    echo antsApplyTransforms -i  /home1/user/data/hcp/freesurfer_repo_hcp/${a}/mri/aparc+aseg.mgz -t /home1/user/data/hcp/mniaffines/T1w_acpc_dc_${a#hcp_}_mni0Affine.txt -r /home/user/devel/hippodeep-sub/boxes/boxHippoL_128.nii.gz -o ${a}_001_aseg_boxL.nii --float -n MultiLabel[0.01]
    echo fslmaths ${a}_001_aseg_boxL.nii -thr 3.5 -uthr 4.5 -bin ${a}_001_ventricle_Lat_boxL.nii.gz -odt char
    echo fslmaths ${a}_001_aseg_boxL.nii -thr 4.5 -uthr 5.5 -bin ${a}_001_ventricle_Inf_boxL.nii.gz -odt char
    echo fslmaths ${a}_001_ventricle_Inf_boxL.nii.gz -mul 2 -add ${a}_001_ventricle_Lat_boxL.nii.gz ${a}_001_ventricles_boxL.nii.gz
    echo /bin/rm ${a}_001_aseg_boxL.nii ${a}_001_ventricle_Lat_boxL.nii.gz ${a}_001_ventricle_Inf_boxL.nii.gz

    #Right
    echo antsApplyTransforms -i  /home1/user/data/hcp/freesurfer_repo_hcp/${a}/mri/aparc+aseg.mgz -t /home1/user/data/hcp/mniaffines/T1w_acpc_dc_${a#hcp_}_mni0Affine.txt -r /home/user/devel/hippodeep-sub/boxes/boxHippoR_128.nii.gz -o ${a}_001_aseg_boxR.nii --float -n MultiLabel[0.01]
    echo fslmaths ${a}_001_aseg_boxR.nii -thr 42.5 -uthr 43.5 -bin ${a}_001_ventricle_Lat_boxR.nii.gz -odt char
    echo fslmaths ${a}_001_aseg_boxR.nii -thr 43.5 -uthr 44.5 -bin ${a}_001_ventricle_Inf_boxR.nii.gz -odt char
    echo fslmaths ${a}_001_ventricle_Inf_boxR.nii.gz -mul 2 -add ${a}_001_ventricle_Lat_boxR.nii.gz ${a}_001_ventricles_boxR.nii.gz
    echo /bin/rm ${a}_001_aseg_boxR.nii ${a}_001_ventricle_Lat_boxR.nii.gz ${a}_001_ventricle_Inf_boxR.nii.gz
done


cat ids.txt | while read a; do echo "python augment_cortex.py ${a}_001_orig_boxR.nii.gz"; echo "python augment_cortex.py ${a}_001_orig_boxL.nii.gz" ; done 


codes = 203, 204, 205, 206, 208, 209, 210, 211, 212, 214, 215, 226

